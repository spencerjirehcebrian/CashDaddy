{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 14:53:06"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 14:53:06"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 14:53:06"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 14:53:06"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 14:53:06"}
{"level":"info","message":"KYC microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 14:53:09"}
{"level":"info","message":"Received message:","offset":"0","partition":0,"service":"shared","timestamp":"2024-08-25 14:53:09","topic":"kyc-events","value":"{\"action\":\"getKycStatus\",\"payload\":{\"userId\":\"66c94fc25cb63642498b643d\"}}"}
{"level":"warn","message":"Unknown action received: getKycStatus","service":"shared","timestamp":"2024-08-25 14:53:09"}
{"level":"info","message":"Received message:","offset":"1","partition":0,"service":"shared","timestamp":"2024-08-25 14:53:09","topic":"kyc-events","value":"{\"action\":\"getKycStatus\",\"payload\":{\"userId\":\"66c94fc25cb63642498b643d\"}}"}
{"level":"warn","message":"Unknown action received: getKycStatus","service":"shared","timestamp":"2024-08-25 14:53:09"}
{"level":"info","message":"Received message:","offset":"2","partition":0,"service":"shared","timestamp":"2024-08-25 14:53:09","topic":"kyc-events","value":"{\"action\":\"getOwnKYC\",\"payload\":{\"userId\":\"66c94fc25cb63642498b643d\"}}"}
{"level":"warn","message":"getOwnKYC action received without userId","service":"shared","timestamp":"2024-08-25 14:53:09"}
{"level":"info","message":"Received message:","offset":"3","partition":0,"service":"shared","timestamp":"2024-08-25 14:53:09","topic":"kyc-events","value":"{\"action\":\"getOwnKYC\",\"payload\":{\"userId\":\"66c9fa17ac811a0ff3729b30\"}}"}
{"level":"warn","message":"getOwnKYC action received without userId","service":"shared","timestamp":"2024-08-25 14:53:09"}
{"level":"info","message":"Received message:","offset":"4","partition":0,"service":"shared","timestamp":"2024-08-25 14:53:09","topic":"kyc-events","value":"{\"action\":\"getOwnKYC\",\"payload\":{\"userId\":\"66c9fa17ac811a0ff3729b30\"}}"}
{"level":"warn","message":"getOwnKYC action received without userId","service":"shared","timestamp":"2024-08-25 14:53:09"}
{"level":"info","message":"Received message:","offset":"5","partition":0,"service":"shared","timestamp":"2024-08-25 14:53:09","topic":"kyc-events","value":"{\"action\":\"getOwnKYC\",\"payload\":{\"userId\":\"66c9fa17ac811a0ff3729b30\"}}"}
{"level":"warn","message":"getOwnKYC action received without userId","service":"shared","timestamp":"2024-08-25 14:53:09"}
{"level":"info","message":"Received message:","offset":"6","partition":0,"service":"shared","timestamp":"2024-08-25 14:53:09","topic":"kyc-events","value":"{\"action\":\"getOwnKYC\",\"payload\":{\"userId\":\"66c9fa17ac811a0ff3729b30\"}}"}
{"level":"warn","message":"getOwnKYC action received without userId","service":"shared","timestamp":"2024-08-25 14:53:09"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 15:18:34"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 15:18:34"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 15:18:34"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 15:18:34"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 15:18:34"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 15:18:57"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 15:18:57"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 15:18:57"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 15:18:57"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 15:18:57"}
{"level":"info","message":"KYC microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 15:19:07"}
{"level":"error","message":"Error: Token has expired\n    at AuthService.verifyToken (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/services/auth/auth.service.js:20:23)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:28:50\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at /home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:175:3)","service":"shared","timestamp":"2024-08-25 15:20:54"}
{"level":"info","message":"Response: 401 An error occurred","service":"shared","timestamp":"2024-08-25 15:20:54"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 15:26:07"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 15:26:07"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 15:26:07"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 15:26:07"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 15:26:07"}
{"level":"info","message":"KYC microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 15:26:10"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 15:36:53"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 15:36:53"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 15:36:53"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 15:36:53"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 15:36:53"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 15:36:56"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 15:48:08"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 15:48:08"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 15:48:08"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 15:48:08"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 15:48:08"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 15:48:11"}
{"level":"error","message":"Error: Token has expired\n    at AuthService.verifyToken (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/services/auth/auth.service.js:20:23)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:28:50\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at /home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:175:3)","service":"shared","timestamp":"2024-08-25 15:48:22"}
{"level":"info","message":"Response: 401 An error occurred","service":"shared","timestamp":"2024-08-25 15:48:22"}
{"level":"error","message":"Error: Validation failed\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/validation.middleware.js:7:19\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:61:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"shared","timestamp":"2024-08-25 15:48:59"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 15:48:59"}
{"level":"error","message":"Error: Validation failed\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/validation.middleware.js:7:19\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:61:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"shared","timestamp":"2024-08-25 15:49:55"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 15:49:55"}
{"level":"error","message":"Error: Validation failed\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/validation.middleware.js:7:19\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:61:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"shared","timestamp":"2024-08-25 15:50:10"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 15:50:10"}
{"level":"error","message":"SyntaxError: Unexpected token '}', ...\"alance\":\r\n}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at parse (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/body-parser/lib/types/json.js:92:19)\n    at /home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/body-parser/lib/read.js:128:18\n    at AsyncResource.runInAsyncScope (node:async_hooks:206:9)\n    at invokeCallback (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/raw-body/index.js:238:16)\n    at done (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/raw-body/index.js:227:7)\n    at IncomingMessage.onEnd (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/raw-body/index.js:287:7)\n    at IncomingMessage.emit (node:events:520:28)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","service":"shared","timestamp":"2024-08-25 15:50:15"}
{"level":"info","message":"Response: 503 Server error","service":"shared","timestamp":"2024-08-25 15:50:15"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 16:07:03"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 16:07:03"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 16:07:03"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 16:07:03"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 16:07:03"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 16:07:06"}
{"level":"error","message":"SyntaxError: Unexpected token '}', ...\"alance\":\r\n}\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at parse (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/body-parser/lib/types/json.js:92:19)\n    at /home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/body-parser/lib/read.js:128:18\n    at AsyncResource.runInAsyncScope (node:async_hooks:206:9)\n    at invokeCallback (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/raw-body/index.js:238:16)\n    at done (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/raw-body/index.js:227:7)\n    at IncomingMessage.onEnd (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/raw-body/index.js:287:7)\n    at IncomingMessage.emit (node:events:520:28)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","service":"shared","timestamp":"2024-08-25 16:07:24"}
{"level":"info","message":"Response: 503 Server error","service":"shared","timestamp":"2024-08-25 16:07:24"}
{"level":"error","message":"Error: Validation failed\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/validation.middleware.js:7:19\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:61:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"shared","timestamp":"2024-08-25 16:07:38"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:07:38"}
{"level":"error","message":"Error in createWallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:07:43"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:07:43"}
{"level":"error","message":"Error: Failed to create wallet: User already has a wallet\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:11:28)","service":"shared","timestamp":"2024-08-25 16:07:43"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:07:43"}
{"level":"info","message":"Cacheable decorator: caching method getBalance with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 16:08:22"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 16:08:22"}
{"level":"info","message":"Cache miss: wallet:66c9fa17ac811a0ff3729b30. Executing method and caching result.","service":"shared","timestamp":"2024-08-25 16:08:22"}
{"level":"info","message":"Method result cached with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 16:08:22"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 16:08:22"}
{"level":"error","message":"Error: Validation failed\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/validation.middleware.js:7:19\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:61:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"shared","timestamp":"2024-08-25 16:12:12"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:12:12"}
{"level":"error","message":"Error: Validation failed\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/validation.middleware.js:7:19\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:61:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"shared","timestamp":"2024-08-25 16:12:26"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:12:26"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 16:13:54"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 16:13:54"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 16:13:54"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 16:13:54"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 16:13:54"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 16:14:16"}
{"level":"error","message":"Error: Validation failed\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/validation.middleware.js:7:19\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:61:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"shared","timestamp":"2024-08-25 16:14:17"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:14:17"}
{"level":"info","message":"Simulated payment intent for test payment method: {\"id\":\"pi_simulated_9da4eba8215538bf1033b596992c41c2\",\"status\":\"succeeded\",\"amount\":100000}","service":"shared","timestamp":"2024-08-25 16:14:30"}
{"_message":"KnowYourCustomer validation failed","errors":{"stripeCustomerId":{"kind":"required","message":"Path `stripeCustomerId` is required.","name":"ValidatorError","path":"stripeCustomerId","properties":{"message":"Path `stripeCustomerId` is required.","path":"stripeCustomerId","type":"required"}}},"level":"error","message":"Error in deposit:","service":"shared","timestamp":"2024-08-25 16:14:30"}
{"level":"info","message":"Response: 400 Deposit failed: KnowYourCustomer validation failed: stripeCustomerId: Path `stripeCustomerId` is required.","service":"shared","timestamp":"2024-08-25 16:14:30"}
{"level":"error","message":"Error: Validation failed\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/validation.middleware.js:7:19\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:61:17\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","service":"shared","timestamp":"2024-08-25 16:14:38"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:14:38"}
{"level":"error","message":"Error in withdraw:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:14:41"}
{"level":"error","message":"Error withdrawing funds:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:14:41"}
{"level":"error","message":"Error: Withdrawal failed: Insufficient funds\n    at WalletService.withdraw (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:144:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.withdraw (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:51:28)","service":"shared","timestamp":"2024-08-25 16:14:41"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:14:41"}
{"level":"error","message":"Error in transfer:","service":"shared","statusCode":404,"timestamp":"2024-08-25 16:18:56"}
{"level":"error","message":"Error transferring funds:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:18:56"}
{"level":"error","message":"Error: Transfer failed: One or both wallets not found\n    at WalletService.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:173:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:39:28)","service":"shared","timestamp":"2024-08-25 16:18:56"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:18:56"}
{"level":"info","message":"Cacheable decorator: caching method getTransactionHistory with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 16:19:33"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 16:19:33"}
{"level":"info","message":"Cache hit: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 16:19:33"}
{"level":"info","message":"Response: 200 Transaction history retrieved successfully","service":"shared","timestamp":"2024-08-25 16:19:33"}
{"level":"error","message":"Error in createWallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:32:11"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:32:11"}
{"level":"error","message":"Error: Failed to create wallet: User already has a wallet\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:11:28)","service":"shared","timestamp":"2024-08-25 16:32:11"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:32:11"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 16:53:55"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 16:53:55"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 16:53:55"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 16:53:55"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 16:53:55"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 16:53:58"}
{"level":"error","message":"Error: Token has expired\n    at AuthService.verifyToken (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/services/auth/auth.service.js:20:23)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:28:50\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at /home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:175:3)","service":"shared","timestamp":"2024-08-25 16:54:16"}
{"level":"info","message":"Response: 401 An error occurred","service":"shared","timestamp":"2024-08-25 16:54:16"}
{"level":"error","message":"Error in createWallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:54:21"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:54:21"}
{"level":"error","message":"Error: Failed to create wallet: User already has a wallet\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:11:28)","service":"shared","timestamp":"2024-08-25 16:54:21"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:54:21"}
{"level":"error","message":"Error in createWallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:55:22"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:55:22"}
{"level":"error","message":"Error: Failed to create wallet: User already has a wallet\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:11:28)","service":"shared","timestamp":"2024-08-25 16:55:22"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:55:22"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 16:57:51"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 16:57:51"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 16:57:51"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 16:57:51"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 16:57:51"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 16:58:13"}
{"level":"error","message":"Error in createWallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:58:33"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 16:58:33"}
{"level":"error","message":"Error: Failed to create wallet: User already has a wallet\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:10:28)","service":"shared","timestamp":"2024-08-25 16:58:33"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 16:58:33"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 16:59:59"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 16:59:59"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 16:59:59"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 16:59:59"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 16:59:59"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 17:00:18"}
{"level":"error","message":"Error creating Stripe customer","service":"shared","statusCode":404,"timestamp":"2024-08-25 17:01:02"}
{"level":"error","message":"Error creating Stripe customer: User cannot be verified","service":"shared","timestamp":"2024-08-25 17:01:02"}
{"level":"error","message":"Error in createWallet:","service":"shared","timestamp":"2024-08-25 17:01:02"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 17:01:02"}
{"level":"error","message":"Error: Failed to create wallet: Failed to create Stripe customer: User cannot be verified\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at runNextTicks (node:internal/process/task_queues:60:5)\n    at process.processTimers (node:internal/timers:511:9)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:10:28)","service":"shared","timestamp":"2024-08-25 17:01:02"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 17:01:02"}
{"level":"error","message":"Error creating Stripe customer","service":"shared","statusCode":404,"timestamp":"2024-08-25 17:02:46"}
{"level":"error","message":"Error creating Stripe customer: User cannot be verified","service":"shared","timestamp":"2024-08-25 17:02:46"}
{"level":"error","message":"Error in createWallet:","service":"shared","timestamp":"2024-08-25 17:02:46"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 17:02:46"}
{"level":"error","message":"Error: Failed to create wallet: Failed to create Stripe customer: User cannot be verified\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at runNextTicks (node:internal/process/task_queues:60:5)\n    at process.processTimers (node:internal/timers:511:9)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:10:28)","service":"shared","timestamp":"2024-08-25 17:02:46"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 17:02:46"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 18:53:16"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 18:53:16"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 18:53:16"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 18:53:16"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 18:53:16"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 18:53:19"}
{"level":"error","message":"Error creating Stripe customer","service":"shared","statusCode":404,"timestamp":"2024-08-25 18:53:56"}
{"level":"error","message":"Error creating Stripe customer: User cannot be verified","service":"shared","timestamp":"2024-08-25 18:53:56"}
{"level":"error","message":"Error in createWallet:","service":"shared","timestamp":"2024-08-25 18:53:56"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 18:53:56"}
{"level":"error","message":"Error: Failed to create wallet: Failed to create Stripe customer: User cannot be verified\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at runNextTicks (node:internal/process/task_queues:60:5)\n    at process.processTimers (node:internal/timers:511:9)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:10:28)","service":"shared","timestamp":"2024-08-25 18:53:56"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 18:53:56"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 19:00:01"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 19:00:01"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 19:00:01"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 19:00:01"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 19:00:01"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 19:00:04"}
{"level":"error","message":"Error creating Stripe customer","service":"shared","statusCode":404,"timestamp":"2024-08-25 19:00:25"}
{"level":"error","message":"Error creating Stripe customer: User cannot be verified","service":"shared","timestamp":"2024-08-25 19:00:25"}
{"level":"error","message":"Error in createWallet:","service":"shared","timestamp":"2024-08-25 19:00:25"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 19:00:25"}
{"level":"error","message":"Error: Failed to create wallet: Failed to create Stripe customer: User cannot be verified\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:10:28)","service":"shared","timestamp":"2024-08-25 19:00:25"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 19:00:25"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 19:03:29"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 19:03:29"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 19:03:29"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 19:03:29"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 19:03:29"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 19:03:30"}
{"level":"error","message":"Error creating Stripe customer","service":"shared","statusCode":404,"timestamp":"2024-08-25 19:03:56"}
{"level":"error","message":"Error creating Stripe customer: User cannot be verified","service":"shared","timestamp":"2024-08-25 19:03:56"}
{"level":"error","message":"Error in createWallet:","service":"shared","timestamp":"2024-08-25 19:03:56"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 19:03:56"}
{"level":"error","message":"Error: Failed to create wallet: Failed to create Stripe customer: User cannot be verified\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at runNextTicks (node:internal/process/task_queues:60:5)\n    at process.processTimers (node:internal/timers:511:9)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:10:28)","service":"shared","timestamp":"2024-08-25 19:03:56"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 19:03:56"}
{"level":"info","message":"Received message:","offset":"0","partition":0,"service":"shared","timestamp":"2024-08-25 19:05:04","topic":"wallet-events","value":"{\"action\":\"returnData\",\"payload\":{\"_id\":\"66c9fa17ac811a0ff3729b30\",\"email\":\"user2@example.com\",\"firstName\":\"John\",\"lastName\":\"Doe\",\"role\":\"USER\",\"status\":\"ACTIVE\",\"createdAt\":\"2024-08-24T15:19:51.917Z\",\"updatedAt\":\"2024-08-24T15:37:00.466Z\",\"userProfile\":{\"_id\":\"66c9fa1cac811a0ff3729b34\",\"user\":\"66c9fa17ac811a0ff3729b30\",\"dateOfBirth\":\"1990-01-01T00:00:00.000Z\",\"phoneNumber\":\"+1234567890\",\"addressLine1\":\"123 Main St\",\"city\":\"Anytown\",\"state\":\"State\",\"country\":\"Country\",\"postalCode\":\"12345\",\"createdAt\":\"2024-08-24T15:19:56.509Z\",\"updatedAt\":\"2024-08-24T15:19:56.509Z\"},\"kyc\":\"66c9fa1fb6c48fdf7d5a57df\",\"stripeCustomerId\":\"cus_Qinc77TfmLjnOX\"}}"}
{"level":"info","message":"Received message:","offset":"1","partition":0,"service":"shared","timestamp":"2024-08-25 19:05:04","topic":"wallet-events","value":"{\"action\":\"returnUser\",\"payload\":{\"_id\":\"66c9fa17ac811a0ff3729b30\",\"email\":\"user2@example.com\",\"firstName\":\"John\",\"lastName\":\"Doe\",\"role\":\"USER\",\"status\":\"ACTIVE\",\"createdAt\":\"2024-08-24T15:19:51.917Z\",\"updatedAt\":\"2024-08-25T11:05:04.923Z\",\"userProfile\":{\"_id\":\"66c9fa1cac811a0ff3729b34\",\"user\":\"66c9fa17ac811a0ff3729b30\",\"dateOfBirth\":\"1990-01-01T00:00:00.000Z\",\"phoneNumber\":\"+1234567890\",\"addressLine1\":\"123 Main St\",\"city\":\"Anytown\",\"state\":\"State\",\"country\":\"Country\",\"postalCode\":\"12345\",\"createdAt\":\"2024-08-24T15:19:56.509Z\",\"updatedAt\":\"2024-08-24T15:19:56.509Z\"},\"kyc\":\"66c9fa1fb6c48fdf7d5a57df\",\"stripeCustomerId\":\"cus_Qj6SZaB5TsjsYZ\"}}"}
{"level":"warn","message":"Unknown action received: returnUser","service":"shared","timestamp":"2024-08-25 19:05:04"}
{"level":"error","message":"Error creating Stripe customer","service":"shared","statusCode":404,"timestamp":"2024-08-25 19:05:14"}
{"level":"error","message":"Error creating Stripe customer: User update cannot be verified","service":"shared","timestamp":"2024-08-25 19:05:14"}
{"level":"error","message":"Error in createWallet:","service":"shared","timestamp":"2024-08-25 19:05:14"}
{"level":"error","message":"Error creating wallet:","service":"shared","statusCode":400,"timestamp":"2024-08-25 19:05:14"}
{"level":"error","message":"Error: Failed to create wallet: Failed to create Stripe customer: User update cannot be verified\n    at WalletService.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:58:23)\n    at runNextTicks (node:internal/process/task_queues:60:5)\n    at process.processTimers (node:internal/timers:511:9)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.createWallet (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:10:28)","service":"shared","timestamp":"2024-08-25 19:05:14"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 19:05:14"}
{"level":"info","message":"Received message:","offset":"2","partition":0,"service":"shared","timestamp":"2024-08-25 19:18:59","topic":"wallet-events","value":"{\"action\":\"returnData\",\"payload\":{\"_id\":\"66c9fa17ac811a0ff3729b30\",\"email\":\"user2@example.com\",\"firstName\":\"John\",\"lastName\":\"Doe\",\"role\":\"USER\",\"status\":\"ACTIVE\",\"createdAt\":\"2024-08-24T15:19:51.917Z\",\"updatedAt\":\"2024-08-25T11:05:04.923Z\",\"userProfile\":{\"_id\":\"66c9fa1cac811a0ff3729b34\",\"user\":\"66c9fa17ac811a0ff3729b30\",\"dateOfBirth\":\"1990-01-01T00:00:00.000Z\",\"phoneNumber\":\"+1234567890\",\"addressLine1\":\"123 Main St\",\"city\":\"Anytown\",\"state\":\"State\",\"country\":\"Country\",\"postalCode\":\"12345\",\"createdAt\":\"2024-08-24T15:19:56.509Z\",\"updatedAt\":\"2024-08-24T15:19:56.509Z\"},\"kyc\":\"66c9fa1fb6c48fdf7d5a57df\"}}"}
{"level":"info","message":"Received message:","offset":"3","partition":0,"service":"shared","timestamp":"2024-08-25 19:19:00","topic":"wallet-events","value":"{\"action\":\"returnData\",\"payload\":{\"_id\":\"66c9fa17ac811a0ff3729b30\",\"email\":\"user2@example.com\",\"firstName\":\"John\",\"lastName\":\"Doe\",\"role\":\"USER\",\"status\":\"ACTIVE\",\"createdAt\":\"2024-08-24T15:19:51.917Z\",\"updatedAt\":\"2024-08-25T11:19:00.706Z\",\"userProfile\":{\"_id\":\"66c9fa1cac811a0ff3729b34\",\"user\":\"66c9fa17ac811a0ff3729b30\",\"dateOfBirth\":\"1990-01-01T00:00:00.000Z\",\"phoneNumber\":\"+1234567890\",\"addressLine1\":\"123 Main St\",\"city\":\"Anytown\",\"state\":\"State\",\"country\":\"Country\",\"postalCode\":\"12345\",\"createdAt\":\"2024-08-24T15:19:56.509Z\",\"updatedAt\":\"2024-08-24T15:19:56.509Z\"},\"kyc\":\"66c9fa1fb6c48fdf7d5a57df\",\"stripeCustomerId\":\"cus_Qj6gTqTx59mh2r\"}}"}
{"level":"info","message":"Stripe customer created for user 66c9fa17ac811a0ff3729b30 with ID cus_Qj6gTqTx59mh2r","service":"shared","timestamp":"2024-08-25 19:19:00"}
{"level":"info","message":"Wallet created for user 66c9fa17ac811a0ff3729b30 with initial balance 0","service":"shared","timestamp":"2024-08-25 19:19:00"}
{"level":"info","message":"Invalidating cache with key: user:66c9fa17ac811a0ff3729b30:0","service":"shared","timestamp":"2024-08-25 19:19:00"}
{"level":"info","message":"Invalidating cache with key: wallet:66c9fa17ac811a0ff3729b30:0","service":"shared","timestamp":"2024-08-25 19:19:00"}
{"level":"info","message":"Response: 201 Wallet created successfully","service":"shared","timestamp":"2024-08-25 19:19:00"}
{"level":"info","message":"Cacheable decorator: caching method getBalance with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:19:41"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:19:41"}
{"level":"info","message":"Cache miss: wallet:66c9fa17ac811a0ff3729b30. Executing method and caching result.","service":"shared","timestamp":"2024-08-25 19:19:41"}
{"level":"info","message":"Method result cached with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:19:41"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 19:19:41"}
{"level":"info","message":"Simulated payment intent for test payment method: {\"id\":\"pi_simulated_288da3d04b00cdbc5119c27bcabb008b\",\"status\":\"succeeded\",\"amount\":100000}","service":"shared","timestamp":"2024-08-25 19:19:45"}
{"_message":"Transaction validation failed","errors":{"status":{"kind":"enum","message":"`completed` is not a valid enum value for path `status`.","name":"ValidatorError","path":"status","properties":{"enumValues":["PENDING","COMPLETED","FAILED"],"message":"`completed` is not a valid enum value for path `status`.","path":"status","type":"enum","value":"completed"},"value":"completed"}},"level":"error","message":"Error in deposit:","service":"shared","timestamp":"2024-08-25 19:19:45"}
{"level":"info","message":"Response: 400 Deposit failed: Transaction validation failed: status: `completed` is not a valid enum value for path `status`.","service":"shared","timestamp":"2024-08-25 19:19:45"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 19:23:59"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 19:23:59"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 19:23:59"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 19:23:59"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 19:23:59"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 19:24:02"}
{"level":"info","message":"Simulated payment intent for test payment method: {\"id\":\"pi_simulated_d93bfecb303b2169b1915e85a3bf5890\",\"status\":\"succeeded\",\"amount\":100000}","service":"shared","timestamp":"2024-08-25 19:24:05"}
{"level":"info","message":"Transaction created for user 66c9fa17ac811a0ff3729b30 with deposit amount 1000 and transaction ID 66cb1455c1c73b5b90a7d243","service":"shared","timestamp":"2024-08-25 19:24:05"}
{"level":"info","message":"Invalidating cache with key: wallet:66c9fa17ac811a0ff3729b30:1000:pm_card_mastercard","service":"shared","timestamp":"2024-08-25 19:24:05"}
{"level":"info","message":"Response: 200 Deposit successful","service":"shared","timestamp":"2024-08-25 19:24:05"}
{"level":"info","message":"Cacheable decorator: caching method getBalance with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:24:09"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:24:09"}
{"level":"info","message":"Cache hit: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:24:09"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 19:24:09"}
{"level":"info","message":"Simulated payment intent for test payment method: {\"id\":\"pi_simulated_9d8916d0a24aa044fbe17269c2ee9a1f\",\"status\":\"succeeded\",\"amount\":100000}","service":"shared","timestamp":"2024-08-25 19:24:13"}
{"level":"info","message":"Transaction created for user 66c9fa17ac811a0ff3729b30 with deposit amount 1000 and transaction ID 66cb145dc1c73b5b90a7d247","service":"shared","timestamp":"2024-08-25 19:24:13"}
{"level":"info","message":"Invalidating cache with key: wallet:66c9fa17ac811a0ff3729b30:1000:pm_card_mastercard","service":"shared","timestamp":"2024-08-25 19:24:13"}
{"level":"info","message":"Response: 200 Deposit successful","service":"shared","timestamp":"2024-08-25 19:24:13"}
{"level":"info","message":"Cacheable decorator: caching method getBalance with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:24:15"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:24:15"}
{"level":"info","message":"Cache hit: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:24:15"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 19:24:15"}
{"level":"info","message":"Cacheable decorator: caching method getTransactionHistory with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:24:19"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:24:19"}
{"level":"info","message":"Cache hit: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:24:19"}
{"level":"info","message":"Response: 200 Transaction history retrieved successfully","service":"shared","timestamp":"2024-08-25 19:24:19"}
{"level":"info","message":"Cacheable decorator: caching method getBalance with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:33:20"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:33:20"}
{"level":"info","message":"Cache hit: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:33:20"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 19:33:20"}
{"level":"info","message":"Simulated payment intent for test payment method: {\"id\":\"pi_simulated_8828fb8dcd362d8ed5879f88049e5f8b\",\"status\":\"succeeded\",\"amount\":100000}","service":"shared","timestamp":"2024-08-25 19:39:14"}
{"level":"info","message":"Transaction created for user 66c9fa17ac811a0ff3729b30 with deposit amount 1000 and transaction ID 66cb17e2c1c73b5b90a7d24b","service":"shared","timestamp":"2024-08-25 19:39:14"}
{"level":"info","message":"Invalidating cache with key: wallet:66c9fa17ac811a0ff3729b30:1000:pm_card_mastercard","service":"shared","timestamp":"2024-08-25 19:39:14"}
{"level":"info","message":"Response: 200 Deposit successful","service":"shared","timestamp":"2024-08-25 19:39:14"}
{"level":"info","message":"Cacheable decorator: caching method getBalance with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:39:18"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:39:18"}
{"level":"info","message":"Cache hit: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:39:18"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 19:39:18"}
{"level":"info","message":"Cacheable decorator: caching method getBalance with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:40:15"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:40:15"}
{"level":"info","message":"Cache hit: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:40:15"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 19:40:15"}
{"level":"info","message":"Simulated payment intent for test payment method: {\"id\":\"pi_simulated_47e250b6f6083f61b92968e34f8e4ab4\",\"status\":\"succeeded\",\"amount\":100000}","service":"shared","timestamp":"2024-08-25 19:40:27"}
{"level":"info","message":"Transaction created for user 66c9fa17ac811a0ff3729b30 with deposit amount 1000 and transaction ID 66cb182bc1c73b5b90a7d24f","service":"shared","timestamp":"2024-08-25 19:40:27"}
{"level":"info","message":"Invalidating cache with key: wallet:66c9fa17ac811a0ff3729b30:1000:pm_card_mastercard","service":"shared","timestamp":"2024-08-25 19:40:27"}
{"level":"info","message":"Response: 200 Deposit successful","service":"shared","timestamp":"2024-08-25 19:40:27"}
{"level":"info","message":"Cacheable decorator: caching method getBalance with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:40:28"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:40:28"}
{"level":"info","message":"Cache miss: wallet:66c9fa17ac811a0ff3729b30. Executing method and caching result.","service":"shared","timestamp":"2024-08-25 19:40:28"}
{"level":"info","message":"Method result cached with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:40:29"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 19:40:29"}
{"level":"info","message":"Simulated payment intent for test payment method: {\"id\":\"pi_simulated_c3a9fc08b10653cac917c684ae9fd35b\",\"status\":\"succeeded\",\"amount\":100000}","service":"shared","timestamp":"2024-08-25 19:40:31"}
{"level":"info","message":"Transaction created for user 66c9fa17ac811a0ff3729b30 with deposit amount 1000 and transaction ID 66cb182fc1c73b5b90a7d254","service":"shared","timestamp":"2024-08-25 19:40:31"}
{"level":"info","message":"Invalidating cache with key: wallet:66c9fa17ac811a0ff3729b30:1000:pm_card_mastercard","service":"shared","timestamp":"2024-08-25 19:40:31"}
{"level":"info","message":"Response: 200 Deposit successful","service":"shared","timestamp":"2024-08-25 19:40:31"}
{"level":"info","message":"Cacheable decorator: caching method getBalance with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:40:33"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:40:33"}
{"level":"info","message":"Cache hit: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:40:33"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 19:40:33"}
{"level":"info","message":"Cacheable decorator: caching method getBalance with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:47:54"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:47:54"}
{"level":"info","message":"Cache hit: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 19:47:54"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 19:47:54"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 19:55:54"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 19:55:54"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 19:55:54"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 19:55:54"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 19:55:54"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 19:55:57"}
{"level":"error","message":"Error: Token has expired\n    at AuthService.verifyToken (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/services/auth/auth.service.js:20:23)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:28:50\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at /home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:175:3)","service":"shared","timestamp":"2024-08-25 19:56:08"}
{"level":"info","message":"Response: 401 An error occurred","service":"shared","timestamp":"2024-08-25 19:56:08"}
{"level":"error","message":"Error creating payout: The provided key 'sk_test_***********************************************************************************************8EgC' does not have access to account 'cus_Qj6gTqTx59mh2r' (or that account does not exist). Application access may have been revoked.","service":"shared","timestamp":"2024-08-25 19:59:57"}
{"level":"error","message":"Error in withdraw:","service":"shared","timestamp":"2024-08-25 19:59:57"}
{"level":"error","message":"Error withdrawing funds:","service":"shared","statusCode":400,"timestamp":"2024-08-25 19:59:57"}
{"level":"error","message":"Error: Withdrawal failed: Failed to create payout: The provided key 'sk_test_***********************************************************************************************8EgC' does not have access to account 'cus_Qj6gTqTx59mh2r' (or that account does not exist). Application access may have been revoked.\n    at WalletService.withdraw (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:145:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.withdraw (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:50:28)","service":"shared","timestamp":"2024-08-25 19:59:57"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 19:59:57"}
{"level":"info","message":"Simulated payment intent for test payment method: {\"id\":\"pi_simulated_7a10a728de9e36e0efc2c48f009bb613\",\"status\":\"succeeded\",\"amount\":100000}","service":"shared","timestamp":"2024-08-25 20:04:17"}
{"level":"info","message":"Transaction created for user 66c9fa17ac811a0ff3729b30 with deposit amount 1000 and transaction ID 66cb1dc154226479cefb7a51","service":"shared","timestamp":"2024-08-25 20:04:17"}
{"level":"info","message":"Invalidating cache with key: wallet:66c9fa17ac811a0ff3729b30:1000:pm_card_mastercard","service":"shared","timestamp":"2024-08-25 20:04:17"}
{"level":"info","message":"Response: 200 Deposit successful","service":"shared","timestamp":"2024-08-25 20:04:17"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 20:05:05"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 20:05:05"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 20:05:05"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 20:05:05"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 20:05:05"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 20:05:23"}
{"level":"info","message":"Creating PaymentIntent: amount=100000, currency=usd, customerId=cus_Qj6gTqTx59mh2r, paymentMethodId=pm_card_mastercard","service":"shared","timestamp":"2024-08-25 20:05:34"}
{"level":"info","message":"PaymentIntent created: {\"id\":\"pi_3PrfCN00AhGMCNqg0qX5OIHg\",\"object\":\"payment_intent\",\"amount\":100000,\"amount_capturable\":0,\"amount_details\":{\"tip\":{}},\"amount_received\":0,\"application\":null,\"application_fee_amount\":null,\"automatic_payment_methods\":{\"allow_redirects\":\"always\",\"enabled\":true},\"canceled_at\":null,\"cancellation_reason\":null,\"capture_method\":\"automatic_async\",\"client_secret\":\"pi_3PrfCN00AhGMCNqg0qX5OIHg_secret_H321Dm6t9kpn6isjbw5I5g9L4\",\"confirmation_method\":\"automatic\",\"created\":1724587535,\"currency\":\"usd\",\"customer\":\"cus_Qj6gTqTx59mh2r\",\"description\":null,\"invoice\":null,\"last_payment_error\":null,\"latest_charge\":null,\"livemode\":false,\"metadata\":{},\"next_action\":null,\"on_behalf_of\":null,\"payment_method\":\"pm_1PrfCN00AhGMCNqgp2n6hep0\",\"payment_method_configuration_details\":{\"id\":\"pmc_1Prbqx00AhGMCNqgxUQbGp6F\",\"parent\":null},\"payment_method_options\":{\"card\":{\"installments\":null,\"mandate_options\":null,\"network\":null,\"request_three_d_secure\":\"automatic\"},\"cashapp\":{},\"link\":{\"persistent_token\":null}},\"payment_method_types\":[\"card\",\"link\",\"cashapp\"],\"processing\":null,\"receipt_email\":null,\"review\":null,\"setup_future_usage\":\"off_session\",\"shipping\":null,\"source\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"requires_confirmation\",\"transfer_data\":null,\"transfer_group\":null}","service":"shared","timestamp":"2024-08-25 20:05:34"}
{"level":"error","message":"Error confirming PaymentIntent: A `return_url` must be specified because this Payment Intent is configured to automatically accept the payment methods enabled in the Dashboard, some of which may require a full page redirect to succeed. If you do not want to accept redirect-based payment methods, set `automatic_payment_methods[enabled]` to `true` and `automatic_payment_methods[allow_redirects]` to `never` when creating Setup Intents and Payment Intents.","service":"shared","timestamp":"2024-08-25 20:05:35"}
{"level":"error","message":"Error in deposit:","service":"shared","timestamp":"2024-08-25 20:05:35"}
{"level":"info","message":"Response: 400 Deposit failed: Failed to confirm PaymentIntent: A `return_url` must be specified because this Payment Intent is configured to automatically accept the payment methods enabled in the Dashboard, some of which may require a full page redirect to succeed. If you do not want to accept redirect-based payment methods, set `automatic_payment_methods[enabled]` to `true` and `automatic_payment_methods[allow_redirects]` to `never` when creating Setup Intents and Payment Intents.","service":"shared","timestamp":"2024-08-25 20:05:35"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 20:09:20"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 20:09:20"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 20:09:20"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 20:09:20"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 20:09:20"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 20:09:43"}
{"level":"info","message":"Creating PaymentIntent: amount=100000, currency=usd, customerId=cus_Qj6gTqTx59mh2r, paymentMethodId=pm_card_mastercard","service":"shared","timestamp":"2024-08-25 20:11:07"}
{"level":"info","message":"PaymentIntent created: {\"id\":\"pi_3PrfHk00AhGMCNqg0AVSsmnI\",\"object\":\"payment_intent\",\"amount\":100000,\"amount_capturable\":0,\"amount_details\":{\"tip\":{}},\"amount_received\":0,\"application\":null,\"application_fee_amount\":null,\"automatic_payment_methods\":{\"allow_redirects\":\"always\",\"enabled\":true},\"canceled_at\":null,\"cancellation_reason\":null,\"capture_method\":\"automatic_async\",\"client_secret\":\"pi_3PrfHk00AhGMCNqg0AVSsmnI_secret_J7R4RCiIKmqaky8zXWiEHSPEH\",\"confirmation_method\":\"manual\",\"created\":1724587868,\"currency\":\"usd\",\"customer\":\"cus_Qj6gTqTx59mh2r\",\"description\":null,\"invoice\":null,\"last_payment_error\":null,\"latest_charge\":null,\"livemode\":false,\"metadata\":{},\"next_action\":null,\"on_behalf_of\":null,\"payment_method\":\"pm_1PrfHk00AhGMCNqgPo8neh8j\",\"payment_method_configuration_details\":{\"id\":\"pmc_1Prbqx00AhGMCNqgxUQbGp6F\",\"parent\":null},\"payment_method_options\":{\"card\":{\"installments\":null,\"mandate_options\":null,\"network\":null,\"request_three_d_secure\":\"automatic\"},\"cashapp\":{},\"link\":{\"persistent_token\":null}},\"payment_method_types\":[\"card\",\"link\",\"cashapp\"],\"processing\":null,\"receipt_email\":null,\"review\":null,\"setup_future_usage\":\"off_session\",\"shipping\":null,\"source\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"requires_confirmation\",\"transfer_data\":null,\"transfer_group\":null}","service":"shared","timestamp":"2024-08-25 20:11:07"}
{"level":"error","message":"Error in deposit:","service":"shared","statusCode":400,"timestamp":"2024-08-25 20:11:07"}
{"level":"info","message":"Response: 400 Deposit failed: Deposit failed","service":"shared","timestamp":"2024-08-25 20:11:07"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 20:42:01"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 20:42:01"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 20:42:01"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 20:42:01"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 20:42:01"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 20:42:24"}
{"level":"info","message":"Creating PaymentIntent: amount=100000, currency=usd, customerId=cus_Qj6gTqTx59mh2r, paymentMethodId=pm_card_mastercard","service":"shared","timestamp":"2024-08-25 20:43:37"}
{"level":"info","message":"PaymentIntent created: {\"id\":\"pi_3PrfnD00AhGMCNqg0nk2HZh9\",\"object\":\"payment_intent\",\"amount\":100000,\"amount_capturable\":0,\"amount_details\":{\"tip\":{}},\"amount_received\":0,\"application\":null,\"application_fee_amount\":null,\"automatic_payment_methods\":{\"allow_redirects\":\"always\",\"enabled\":true},\"canceled_at\":null,\"cancellation_reason\":null,\"capture_method\":\"manual\",\"client_secret\":\"pi_3PrfnD00AhGMCNqg0nk2HZh9_secret_CLJRLJdcMrRuCIOEYXqUzchuk\",\"confirmation_method\":\"manual\",\"created\":1724589819,\"currency\":\"usd\",\"customer\":\"cus_Qj6gTqTx59mh2r\",\"description\":null,\"invoice\":null,\"last_payment_error\":null,\"latest_charge\":null,\"livemode\":false,\"metadata\":{},\"next_action\":null,\"on_behalf_of\":null,\"payment_method\":\"pm_1PrfnD00AhGMCNqgh8MzZ4Fi\",\"payment_method_configuration_details\":{\"id\":\"pmc_1Prbqx00AhGMCNqgxUQbGp6F\",\"parent\":null},\"payment_method_options\":{\"card\":{\"installments\":null,\"mandate_options\":null,\"network\":null,\"request_three_d_secure\":\"automatic\"},\"cashapp\":{},\"link\":{\"persistent_token\":null}},\"payment_method_types\":[\"card\",\"link\",\"cashapp\"],\"processing\":null,\"receipt_email\":null,\"review\":null,\"setup_future_usage\":\"off_session\",\"shipping\":null,\"source\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"requires_confirmation\",\"transfer_data\":null,\"transfer_group\":null}","service":"shared","timestamp":"2024-08-25 20:43:38"}
{"level":"error","message":"Error confirming PaymentIntent: Invalid URL: An explicit scheme (such as https) must be provided.","service":"shared","timestamp":"2024-08-25 20:43:39"}
{"level":"error","message":"Error in deposit:","service":"shared","timestamp":"2024-08-25 20:43:39"}
{"level":"info","message":"Response: 400 Deposit failed: Failed to confirm PaymentIntent: Invalid URL: An explicit scheme (such as https) must be provided.","service":"shared","timestamp":"2024-08-25 20:43:39"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 20:51:31"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 20:51:31"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 20:51:31"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 20:51:31"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 20:51:31"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 20:51:54"}
{"level":"info","message":"Creating PaymentIntent: amount=100000, currency=usd, customerId=cus_Qj6gTqTx59mh2r, paymentMethodId=pm_card_mastercard","service":"shared","timestamp":"2024-08-25 20:52:13"}
{"level":"info","message":"PaymentIntent created: {\"id\":\"pi_3PrfvW00AhGMCNqg04SBO7c7\",\"object\":\"payment_intent\",\"amount\":100000,\"amount_capturable\":0,\"amount_details\":{\"tip\":{}},\"amount_received\":0,\"application\":null,\"application_fee_amount\":null,\"automatic_payment_methods\":{\"allow_redirects\":\"always\",\"enabled\":true},\"canceled_at\":null,\"cancellation_reason\":null,\"capture_method\":\"manual\",\"client_secret\":\"pi_3PrfvW00AhGMCNqg04SBO7c7_secret_Z5xn0X5fK2yAk9hScpf3AzM1Q\",\"confirmation_method\":\"manual\",\"created\":1724590334,\"currency\":\"usd\",\"customer\":\"cus_Qj6gTqTx59mh2r\",\"description\":null,\"invoice\":null,\"last_payment_error\":null,\"latest_charge\":null,\"livemode\":false,\"metadata\":{},\"next_action\":null,\"on_behalf_of\":null,\"payment_method\":\"pm_1PrfvW00AhGMCNqgET2xPNcl\",\"payment_method_configuration_details\":{\"id\":\"pmc_1Prbqx00AhGMCNqgxUQbGp6F\",\"parent\":null},\"payment_method_options\":{\"card\":{\"installments\":null,\"mandate_options\":null,\"network\":null,\"request_three_d_secure\":\"automatic\"},\"cashapp\":{},\"link\":{\"persistent_token\":null}},\"payment_method_types\":[\"card\",\"link\",\"cashapp\"],\"processing\":null,\"receipt_email\":null,\"review\":null,\"setup_future_usage\":\"off_session\",\"shipping\":null,\"source\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"requires_confirmation\",\"transfer_data\":null,\"transfer_group\":null}","service":"shared","timestamp":"2024-08-25 20:52:13"}
{"level":"info","message":"Confirmed PaymentIntent: pi_3PrfvW00AhGMCNqg04SBO7c7","service":"shared","timestamp":"2024-08-25 20:52:15"}
{"level":"error","message":"Error in deposit:","service":"shared","statusCode":400,"timestamp":"2024-08-25 20:52:15"}
{"level":"info","message":"Response: 400 Deposit failed: Deposit failed: Unexpected payment status requires_capture","service":"shared","timestamp":"2024-08-25 20:52:15"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 21:01:17"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 21:01:17"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 21:01:17"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 21:01:17"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 21:01:17"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 21:01:40"}
{"level":"error","message":"Error: Token has expired\n    at AuthService.verifyToken (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/services/auth/auth.service.js:20:23)\n    at file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/@cash-daddy/shared/dist/middlewares/auth.middleware.js:28:50\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/layer.js:95:5)\n    at /home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/jireh/projects/stratpoint/CashDaddy/wallet-service/node_modules/express/lib/router/index.js:175:3)","service":"shared","timestamp":"2024-08-25 21:05:58"}
{"level":"info","message":"Response: 401 An error occurred","service":"shared","timestamp":"2024-08-25 21:05:58"}
{"level":"info","message":"Simulated payment intent for test payment method: {\"id\":\"pi_simulated_12eb2ac50b623e1b802624a1c52f8cac\",\"status\":\"succeeded\",\"amount\":100000}","service":"shared","timestamp":"2024-08-25 21:07:01"}
{"level":"info","message":"Transaction created for user 66c9fa17ac811a0ff3729b30 with deposit amount 1000 and transaction ID 66cb2c75816af1b2ce45630e","service":"shared","timestamp":"2024-08-25 21:07:01"}
{"level":"info","message":"Invalidating cache with key: wallet:66c9fa17ac811a0ff3729b30:1000:pm_card_mastercard","service":"shared","timestamp":"2024-08-25 21:07:01"}
{"level":"info","message":"Response: 200 Deposit successful","service":"shared","timestamp":"2024-08-25 21:07:01"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 21:08:25"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 21:08:25"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 21:08:25"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 21:08:25"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 21:08:25"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 21:08:30"}
{"level":"info","message":"Creating PaymentIntent: amount=100000, currency=usd, customerId=cus_Qj6gTqTx59mh2r, paymentMethodId=pm_card_mastercard","service":"shared","timestamp":"2024-08-25 21:11:45"}
{"level":"info","message":"PaymentIntent created: {\"id\":\"pi_3PrgEQ00AhGMCNqg1fO2YVSQ\",\"object\":\"payment_intent\",\"amount\":100000,\"amount_capturable\":0,\"amount_details\":{\"tip\":{}},\"amount_received\":100000,\"application\":null,\"application_fee_amount\":null,\"automatic_payment_methods\":null,\"canceled_at\":null,\"cancellation_reason\":null,\"capture_method\":\"automatic_async\",\"client_secret\":\"pi_3PrgEQ00AhGMCNqg1fO2YVSQ_secret_lpKb0OxzJsxJBfXZdmHtLi5w4\",\"confirmation_method\":\"manual\",\"created\":1724591506,\"currency\":\"usd\",\"customer\":\"cus_Qj6gTqTx59mh2r\",\"description\":null,\"invoice\":null,\"last_payment_error\":null,\"latest_charge\":\"ch_3PrgEQ00AhGMCNqg1XrRi3ba\",\"livemode\":false,\"metadata\":{},\"next_action\":null,\"on_behalf_of\":null,\"payment_method\":\"pm_1PrgEQ00AhGMCNqg4R4dsfnr\",\"payment_method_configuration_details\":null,\"payment_method_options\":{\"card\":{\"installments\":null,\"mandate_options\":null,\"network\":null,\"request_three_d_secure\":\"automatic\"}},\"payment_method_types\":[\"card\"],\"processing\":null,\"receipt_email\":null,\"review\":null,\"setup_future_usage\":null,\"shipping\":null,\"source\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"succeeded\",\"transfer_data\":null,\"transfer_group\":null}","service":"shared","timestamp":"2024-08-25 21:11:46"}
{"level":"info","message":"Transaction created for user 66c9fa17ac811a0ff3729b30 with deposit amount 1000 and transaction ID 66cb2d925ad38066ba9a9d62","service":"shared","timestamp":"2024-08-25 21:11:46"}
{"level":"info","message":"Invalidating cache with key: wallet:66c9fa17ac811a0ff3729b30:1000:pm_card_mastercard","service":"shared","timestamp":"2024-08-25 21:11:46"}
{"level":"info","message":"Response: 200 Deposit successful","service":"shared","timestamp":"2024-08-25 21:11:46"}
{"level":"error","message":"Error creating payout: The provided key 'sk_test_***********************************************************************************************8EgC' does not have access to account 'cus_Qj6gTqTx59mh2r' (or that account does not exist). Application access may have been revoked.","service":"shared","timestamp":"2024-08-25 21:13:21"}
{"level":"error","message":"Error in withdraw:","service":"shared","timestamp":"2024-08-25 21:13:21"}
{"level":"error","message":"Error withdrawing funds:","service":"shared","statusCode":400,"timestamp":"2024-08-25 21:13:21"}
{"level":"error","message":"Error: Withdrawal failed: Failed to create payout: The provided key 'sk_test_***********************************************************************************************8EgC' does not have access to account 'cus_Qj6gTqTx59mh2r' (or that account does not exist). Application access may have been revoked.\n    at WalletService.withdraw (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:143:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.withdraw (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:50:28)","service":"shared","timestamp":"2024-08-25 21:13:21"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 21:13:21"}
{"level":"error","message":"Error in transfer:","service":"shared","statusCode":404,"timestamp":"2024-08-25 21:28:32"}
{"level":"error","message":"Error transferring funds:","service":"shared","statusCode":400,"timestamp":"2024-08-25 21:28:32"}
{"level":"error","message":"Error: Transfer failed: One or both wallets not found\n    at WalletService.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:172:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:38:28)","service":"shared","timestamp":"2024-08-25 21:28:32"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 21:28:32"}
{"kind":"ObjectId","level":"error","message":"Error in transfer:","path":"user","reason":{},"service":"shared","stringValue":"\"cus_Qj8mHQePI6DQsX\"","timestamp":"2024-08-25 21:29:15","value":"cus_Qj8mHQePI6DQsX","valueType":"string"}
{"level":"error","message":"Error transferring funds:","service":"shared","statusCode":400,"timestamp":"2024-08-25 21:29:15"}
{"level":"error","message":"Error: Transfer failed: Cast to ObjectId failed for value \"cus_Qj8mHQePI6DQsX\" (type string) at path \"user\" for model \"Wallet\"\n    at WalletService.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:172:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:38:28)","service":"shared","timestamp":"2024-08-25 21:29:15"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 21:29:15"}
{"level":"info","message":"Cacheable decorator: caching method getTransactionHistory with key wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 21:29:38"}
{"level":"info","message":"Attempting to cache method with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 21:29:38"}
{"level":"info","message":"Cache miss: wallet:66c9fa17ac811a0ff3729b30. Executing method and caching result.","service":"shared","timestamp":"2024-08-25 21:29:38"}
{"level":"info","message":"Method result cached with key: wallet:66c9fa17ac811a0ff3729b30","service":"shared","timestamp":"2024-08-25 21:29:38"}
{"level":"info","message":"Response: 200 Transaction history retrieved successfully","service":"shared","timestamp":"2024-08-25 21:29:38"}
{"level":"error","message":"Error creating payout: The provided key 'sk_test_***********************************************************************************************8EgC' does not have access to account 'cus_Qj6gTqTx59mh2r' (or that account does not exist). Application access may have been revoked.","service":"shared","timestamp":"2024-08-25 21:29:56"}
{"level":"error","message":"Error in withdraw:","service":"shared","timestamp":"2024-08-25 21:29:56"}
{"level":"error","message":"Error withdrawing funds:","service":"shared","statusCode":400,"timestamp":"2024-08-25 21:29:56"}
{"level":"error","message":"Error: Withdrawal failed: Failed to create payout: The provided key 'sk_test_***********************************************************************************************8EgC' does not have access to account 'cus_Qj6gTqTx59mh2r' (or that account does not exist). Application access may have been revoked.\n    at WalletService.withdraw (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:143:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.withdraw (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:50:28)","service":"shared","timestamp":"2024-08-25 21:29:56"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 21:29:56"}
{"kind":"ObjectId","level":"error","message":"Error in transfer:","path":"user","reason":{},"service":"shared","stringValue":"\"cus_Qj8mHQePI6DQsX\"","timestamp":"2024-08-25 21:30:00","value":"cus_Qj8mHQePI6DQsX","valueType":"string"}
{"level":"error","message":"Error transferring funds:","service":"shared","statusCode":400,"timestamp":"2024-08-25 21:30:00"}
{"level":"error","message":"Error: Transfer failed: Cast to ObjectId failed for value \"cus_Qj8mHQePI6DQsX\" (type string) at path \"user\" for model \"Wallet\"\n    at WalletService.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:172:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:38:28)","service":"shared","timestamp":"2024-08-25 21:30:00"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 21:30:00"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 21:35:46"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 21:35:46"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 21:35:46"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 21:35:46"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 21:35:46"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 21:35:49"}
{"level":"info","message":"Received message:","offset":"4","partition":0,"service":"shared","timestamp":"2024-08-25 21:36:33","topic":"wallet-events","value":"{\"action\":\"returnData\",\"payload\":{\"_id\":\"66c94fd65cb63642498b6445\",\"email\":\"user@example.com\",\"firstName\":\"John\",\"lastName\":\"Doe\",\"role\":\"USER\",\"status\":\"ACTIVE\",\"createdAt\":\"2024-08-24T03:13:26.220Z\",\"updatedAt\":\"2024-08-24T14:18:17.653Z\",\"userProfile\":{\"_id\":\"66c9cdc2ab995c26c1260cd5\",\"user\":\"66c94fd65cb63642498b6445\",\"dateOfBirth\":\"1990-01-01T00:00:00.000Z\",\"phoneNumber\":\"+1234567890\",\"addressLine1\":\"123 Main St\",\"city\":\"Anytown\",\"state\":\"State\",\"country\":\"Country\",\"postalCode\":\"12345\",\"createdAt\":\"2024-08-24T12:10:42.741Z\",\"updatedAt\":\"2024-08-24T12:10:42.741Z\"},\"kyc\":\"66c9eba9ec8730ad0aec48cd\"}}"}
{"level":"info","message":"Received message:","offset":"5","partition":0,"service":"shared","timestamp":"2024-08-25 21:36:34","topic":"wallet-events","value":"{\"action\":\"returnData\",\"payload\":{\"_id\":\"66c94fd65cb63642498b6445\",\"email\":\"user@example.com\",\"firstName\":\"John\",\"lastName\":\"Doe\",\"role\":\"USER\",\"status\":\"ACTIVE\",\"createdAt\":\"2024-08-24T03:13:26.220Z\",\"updatedAt\":\"2024-08-25T13:36:34.154Z\",\"userProfile\":{\"_id\":\"66c9cdc2ab995c26c1260cd5\",\"user\":\"66c94fd65cb63642498b6445\",\"dateOfBirth\":\"1990-01-01T00:00:00.000Z\",\"phoneNumber\":\"+1234567890\",\"addressLine1\":\"123 Main St\",\"city\":\"Anytown\",\"state\":\"State\",\"country\":\"Country\",\"postalCode\":\"12345\",\"createdAt\":\"2024-08-24T12:10:42.741Z\",\"updatedAt\":\"2024-08-24T12:10:42.741Z\"},\"kyc\":\"66c9eba9ec8730ad0aec48cd\",\"stripeCustomerId\":\"cus_Qj8uGWvXpd7d0p\"}}"}
{"level":"info","message":"Stripe customer created for user 66c94fd65cb63642498b6445 with ID cus_Qj8uGWvXpd7d0p","service":"shared","timestamp":"2024-08-25 21:36:34"}
{"level":"info","message":"Wallet created for user 66c94fd65cb63642498b6445 with initial balance 0","service":"shared","timestamp":"2024-08-25 21:36:34"}
{"level":"info","message":"Invalidating cache with key: user:66c94fd65cb63642498b6445:0","service":"shared","timestamp":"2024-08-25 21:36:34"}
{"level":"info","message":"Invalidating cache with key: wallet:66c94fd65cb63642498b6445:0","service":"shared","timestamp":"2024-08-25 21:36:34"}
{"level":"info","message":"Response: 201 Wallet created successfully","service":"shared","timestamp":"2024-08-25 21:36:34"}
{"level":"info","message":"Creating PaymentIntent: amount=100000, currency=usd, customerId=cus_Qj8uGWvXpd7d0p, paymentMethodId=pm_card_mastercard","service":"shared","timestamp":"2024-08-25 21:36:39"}
{"level":"info","message":"PaymentIntent created: {\"id\":\"pi_3PrgcW00AhGMCNqg0Jw1hHhU\",\"object\":\"payment_intent\",\"amount\":100000,\"amount_capturable\":0,\"amount_details\":{\"tip\":{}},\"amount_received\":100000,\"application\":null,\"application_fee_amount\":null,\"automatic_payment_methods\":null,\"canceled_at\":null,\"cancellation_reason\":null,\"capture_method\":\"automatic_async\",\"client_secret\":\"pi_3PrgcW00AhGMCNqg0Jw1hHhU_secret_kKsWUZLKbqiiuiLdoJvrkim25\",\"confirmation_method\":\"manual\",\"created\":1724593000,\"currency\":\"usd\",\"customer\":\"cus_Qj8uGWvXpd7d0p\",\"description\":null,\"invoice\":null,\"last_payment_error\":null,\"latest_charge\":\"ch_3PrgcW00AhGMCNqg0YU0nt3L\",\"livemode\":false,\"metadata\":{},\"next_action\":null,\"on_behalf_of\":null,\"payment_method\":\"pm_1PrgcW00AhGMCNqgw0TeXxGq\",\"payment_method_configuration_details\":null,\"payment_method_options\":{\"card\":{\"installments\":null,\"mandate_options\":null,\"network\":null,\"request_three_d_secure\":\"automatic\"}},\"payment_method_types\":[\"card\"],\"processing\":null,\"receipt_email\":null,\"review\":null,\"setup_future_usage\":null,\"shipping\":null,\"source\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"succeeded\",\"transfer_data\":null,\"transfer_group\":null}","service":"shared","timestamp":"2024-08-25 21:36:40"}
{"level":"info","message":"Transaction created for user 66c94fd65cb63642498b6445 with deposit amount 1000 and transaction ID 66cb33684864f12a5b94bad1","service":"shared","timestamp":"2024-08-25 21:36:40"}
{"level":"info","message":"Invalidating cache with key: wallet:66c94fd65cb63642498b6445:1000:pm_card_mastercard","service":"shared","timestamp":"2024-08-25 21:36:40"}
{"level":"info","message":"Response: 200 Deposit successful","service":"shared","timestamp":"2024-08-25 21:36:40"}
{"level":"info","message":"Simulated payout for customer cus_Qj8uGWvXpd7d0p: {\"id\":\"po_simulated_d233d85fb7b6afd1e2dff3198d6b3974\",\"status\":\"paid\",\"amount\":100000,\"currency\":\"usd\",\"arrival_date\":1724679404,\"method\":\"standard\",\"type\":\"bank_account\"}","service":"shared","timestamp":"2024-08-25 21:36:44"}
{"level":"info","message":"Transaction created for user 66c94fd65cb63642498b6445 with withdrawal amount 1000 and transaction ID 66cb336c4864f12a5b94bad5","service":"shared","timestamp":"2024-08-25 21:36:44"}
{"level":"info","message":"Invalidating cache with key: wallet:66c94fd65cb63642498b6445:1000","service":"shared","timestamp":"2024-08-25 21:36:44"}
{"level":"info","message":"Response: 200 Withdrawal successful","service":"shared","timestamp":"2024-08-25 21:36:44"}
{"level":"info","message":"Response: 200 Balance retrieved successfully","service":"shared","timestamp":"2024-08-25 21:36:51"}
{"level":"info","message":"Creating PaymentIntent: amount=100000, currency=usd, customerId=cus_Qj8uGWvXpd7d0p, paymentMethodId=pm_card_mastercard","service":"shared","timestamp":"2024-08-25 21:36:55"}
{"level":"info","message":"PaymentIntent created: {\"id\":\"pi_3Prgcm00AhGMCNqg0YiWOWcH\",\"object\":\"payment_intent\",\"amount\":100000,\"amount_capturable\":0,\"amount_details\":{\"tip\":{}},\"amount_received\":100000,\"application\":null,\"application_fee_amount\":null,\"automatic_payment_methods\":null,\"canceled_at\":null,\"cancellation_reason\":null,\"capture_method\":\"automatic_async\",\"client_secret\":\"pi_3Prgcm00AhGMCNqg0YiWOWcH_secret_xYScliUPLHmg8WSbk0dZsfdYz\",\"confirmation_method\":\"manual\",\"created\":1724593016,\"currency\":\"usd\",\"customer\":\"cus_Qj8uGWvXpd7d0p\",\"description\":null,\"invoice\":null,\"last_payment_error\":null,\"latest_charge\":\"ch_3Prgcm00AhGMCNqg0lwg10Ni\",\"livemode\":false,\"metadata\":{},\"next_action\":null,\"on_behalf_of\":null,\"payment_method\":\"pm_1Prgcm00AhGMCNqg1maKEfFP\",\"payment_method_configuration_details\":null,\"payment_method_options\":{\"card\":{\"installments\":null,\"mandate_options\":null,\"network\":null,\"request_three_d_secure\":\"automatic\"}},\"payment_method_types\":[\"card\"],\"processing\":null,\"receipt_email\":null,\"review\":null,\"setup_future_usage\":null,\"shipping\":null,\"source\":null,\"statement_descriptor\":null,\"statement_descriptor_suffix\":null,\"status\":\"succeeded\",\"transfer_data\":null,\"transfer_group\":null}","service":"shared","timestamp":"2024-08-25 21:36:56"}
{"level":"info","message":"Transaction created for user 66c94fd65cb63642498b6445 with deposit amount 1000 and transaction ID 66cb33784864f12a5b94bada","service":"shared","timestamp":"2024-08-25 21:36:56"}
{"level":"info","message":"Invalidating cache with key: wallet:66c94fd65cb63642498b6445:1000:pm_card_mastercard","service":"shared","timestamp":"2024-08-25 21:36:56"}
{"level":"info","message":"Response: 200 Deposit successful","service":"shared","timestamp":"2024-08-25 21:36:56"}
{"kind":"ObjectId","level":"error","message":"Error in transfer:","path":"user","reason":{},"service":"shared","stringValue":"\"cus_Qj6gTqTx59mh2r\"","timestamp":"2024-08-25 21:37:15","value":"cus_Qj6gTqTx59mh2r","valueType":"string"}
{"level":"error","message":"Error transferring funds:","service":"shared","statusCode":400,"timestamp":"2024-08-25 21:37:15"}
{"level":"error","message":"Error: Transfer failed: Cast to ObjectId failed for value \"cus_Qj6gTqTx59mh2r\" (type string) at path \"user\" for model \"Wallet\"\n    at WalletService.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:172:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:38:28)","service":"shared","timestamp":"2024-08-25 21:37:15"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 21:37:15"}
{"level":"info","message":"Transaction created for user 66c94fd65cb63642498b6445 with transfer amount 30 and transaction ID 66cb33a44864f12a5b94bae1","service":"shared","timestamp":"2024-08-25 21:37:40"}
{"level":"info","message":"Invalidating cache with key: wallet:66c94fd65cb63642498b6445:66c9fa17ac811a0ff3729b30:30","service":"shared","timestamp":"2024-08-25 21:37:40"}
{"level":"info","message":"Response: 200 Transfer successful","service":"shared","timestamp":"2024-08-25 21:37:40"}
{"level":"info","message":"Connected to MongoDB: mongodb://localhost:27017/cashdaddy_user_dev","service":"shared","timestamp":"2024-08-25 21:42:47"}
{"level":"info","message":"Connected to Redis: redis://localhost:6379","service":"shared","timestamp":"2024-08-25 21:42:47"}
{"level":"info","message":"Connected to Kafka: localhost:29092","service":"shared","timestamp":"2024-08-25 21:42:47"}
{"level":"info","message":"CacheManager initialized with CacheService.","service":"shared","timestamp":"2024-08-25 21:42:47"}
{"level":"info","message":"Connected Kafka Consumer","service":"shared","timestamp":"2024-08-25 21:42:47"}
{"level":"info","message":"Wallet microservice listening on port 3002","service":"shared","timestamp":"2024-08-25 21:43:09"}
{"level":"error","message":"Error creating transfer: No such charge: 'cus_Qj8uGWvXpd7d0p'","service":"shared","timestamp":"2024-08-25 21:43:33"}
{"level":"error","message":"Error in transfer:","service":"shared","timestamp":"2024-08-25 21:43:33"}
{"level":"error","message":"Error transferring funds:","service":"shared","statusCode":400,"timestamp":"2024-08-25 21:43:33"}
{"level":"error","message":"Error: Transfer failed: Failed to create transfer: No such charge: 'cus_Qj8uGWvXpd7d0p'\n    at WalletService.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/services/db/wallet.service.js:177:23)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async descriptor.value (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/decorators/caching.decorator.js:31:28)\n    at async WalletController.transfer (file:///home/jireh/projects/stratpoint/CashDaddy/wallet-service/dist/src/controller/wallet.controller.js:38:28)","service":"shared","timestamp":"2024-08-25 21:43:33"}
{"level":"info","message":"Response: 400 An error occurred","service":"shared","timestamp":"2024-08-25 21:43:33"}
